pipeline {
    agent any
    parameters {
        string(name: 'dbName', defaultValue: 'Northwind', description: 'DB Nameo?')
        string(name: 'dbServer', defaultValue: '192.168.0.106', description: 'DB Server')
    }

            stages {
                stage("Env Variables") {
                    environment { 
                        AN_ACCESS_KEY = credentials('DB_Cred') 
                        }
                        steps {
                            powershell script: '''
                                
                                $Categories = Invoke-Sqlcmd -ServerInstance ${params.dbServer} -Database "${params.dbName}" -Username ${env:AN_ACCESS_KEY_USR} -Password ${env:AN_ACCESS_KEY_PSW} -Query "select *from dbo.Categories" -Querytimeout 600 -Verbose -ErrorAction Continue
                                $Categories.CategoryName 
                                '''
                            }
                        }
                }
            }
        
